<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fun 20</title>
</head>
<body>
  <hr>
  <div id ="time"></div>
  <hr>
  <div id ="timeb"></div>
  <hr>
  <!-- <button>Start Count Down</button>
  <div>Registration closes in <span id="time"></span> minutes!</div> -->
</body>
<script>
  // Declare elems
  const body = document.querySelector("body");
  const button = document.createElement("button");
  const countDownContainer = document.createElement("div");
  const workOutStartsHeader = document.createElement("h1")
  const workoutTypes = ["pushups", "squats", "lunges", "dips"];


  // Declare functions
  beginWorkOut = () => {
    // Display Countdown Timer
    countDownContainer.style.display = "flex";
    // Start CountDown Timer
    // timer.start();
    // Start countdown timer to first workout 
    countDownTimerFiveSecs();

    // Randomize and declare first workout
    declareWorkOut();

    // Set Countdown timer for the workout
    // Notify user when 10 seconds remain.

    // Prompt user their workout complete.

    // Set Countdown timer for the workout
    // Cue next workout

    // After 3 timed workouts call workOutComplete.
  }
  
  countDownTimerFiveSecs = () => {
    var display = document.querySelector('#time');
    var timer = new CountDownTimer(5);
    var timeObj = CountDownTimer.parse(5);

    format(timeObj.minutes, timeObj.seconds);
    timer.onTick(format);

    timer.start();

    if (CountDownTimer.parse(5) >= 3) {
      console.log("hihih");
    }

    function format(minutes, seconds) {
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      display.textContent = minutes + ':' + seconds;
    }
  }

  declareWorkOut = () => {
    const currentWorkOut = workoutTypes[Math.floor(Math.random() * workoutTypes.length)];
    console.log(currentWorkOut);
  }


  // Add Evenet Listeners
  button.addEventListener("click", beginWorkOut);

  // Append // Inner Text
  body.append(button, countDownContainer);
  countDownContainer.append(workOutStartsHeader);
  button.innerText = "Start Workout";
  workOutStartsHeader.innerText = "Workout starts in";

  // Styling 
  countDownContainer.style.display = "none";

  // Oh my countdown timers, and  randomizers. 





// https://stackoverflow.com/questions/20618355/the-simplest-possible-javascript-countdown-timer
// Countdown Timer

function CountDownTimer(duration, granularity) {
  this.duration = duration;
  this.granularity = granularity || 1000;
  this.tickFtns = [];
  this.running = false;
}

CountDownTimer.prototype.start = function() {
  if (this.running) {
    console.log("runnning")
    return;
  }
  this.running = true;
  var start = Date.now(),
      that = this,
      diff, obj;

  (function timer() {
    diff = that.duration - (((Date.now() - start) / 1000) | 0);

    if (diff > 0) {
      setTimeout(timer, that.granularity);
    } else {
      diff = 0;
      that.running = false;
    }

    obj = CountDownTimer.parse(diff);
    that.tickFtns.forEach(function(ftn) {
      ftn.call(this, obj.minutes, obj.seconds);
    }, that);
  }());
};

CountDownTimer.prototype.onTick = function(ftn) {
  if (typeof ftn === 'function') {
    this.tickFtns.push(ftn);
  }
  return this;
};

CountDownTimer.prototype.expired = function() {
  console.log("expired");
  return !this.running;
};

CountDownTimer.parse = function(seconds) {
  return {
    'minutes': (seconds / 60) | 0,
    'seconds': (seconds % 60) | 0
  };
};

window.onload = function() {
  function format(minutes, seconds) {
    minutes = minutes < 10 ? "0" + minutes : minutes;
    seconds = seconds < 10 ? "0" + seconds : seconds;
    display.textContent = minutes + ':' + seconds;
  }
};





</script>


</html>